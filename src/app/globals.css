@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: var(--font-geist-sans), Arial, Helvetica, sans-serif;
}

@layer base {
  :root {
    --background: 0 0% 95%; /* Light gray */
    --foreground: 240 10% 3.9%; /* Default dark text */

    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;

    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;

    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;

    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;

    --primary: 207 68% 53%; /* Calm blue */
    --primary-foreground: 0 0% 100%; /* White text for primary */

    --secondary: 240 4.8% 85%; /* A slightly darker light gray for secondary elements */
    --secondary-foreground: 240 5.9% 10%;

    --accent: 180 100% 25%; /* Teal */
    --accent-foreground: 0 0% 100%; /* White text for accent */

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;

    --ring: 207 68% 53%; /* Primary color for rings */
    --radius: 0.5rem;

    /* Sidebar specific (using default shadcn values, can be themed further if sidebar is complex) */
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 207 68% 53%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 180 100% 25%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 207 68% 53%;
    
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;

    /* Glassmorphism Defaults - Light Mode */
    --glass-color-one-light: 220 80% 95% / 0.4; /* Light, translucent frosty blue */
    --glass-color-two-light: 210 70% 97% / 0.35; /* Lighter, translucent frosty white-blue */
    --glass-border-color-light: 220 30% 70% / 0.5; /* Light border */
    --glass-shadow-light: 0 6px 24px 0 rgba(0, 0, 0, 0.1); /* Softer shadow for light */
    --glass-text-color-light: hsl(240 10% 3.9%);
    --glass-blur-intensity-light: 10px; /* Default blur for light */

    /* Dynamic vars to be set by JS, defaulting to light mode glass vars */
    --dynamic-glass-color-one: hsl(var(--glass-color-one-light));
    --dynamic-glass-color-two: hsl(var(--glass-color-two-light));
    --dynamic-glass-blur: var(--glass-blur-intensity-light);
    --dynamic-glass-border-color: hsl(var(--glass-border-color-light));
    --dynamic-glass-shadow: var(--glass-shadow-light);
    --dynamic-glass-text-color: var(--glass-text-color-light);
  }

  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;

    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;

    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;

    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;

    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;

    --primary: 207 68% 53%; /* Calm blue */
    --primary-foreground: 0 0% 100%;

    --secondary: 240 3.7% 15.9%;
    --secondary-foreground: 0 0% 98%;

    --accent: 180 100% 25%; /* Teal */
    --accent-foreground: 0 0% 100%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;

    --ring: 207 68% 53%;
    
    /* Sidebar specific dark */
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 207 68% 53%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 180 100% 25%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 207 68% 53%;

    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;

    /* Glassmorphism Defaults - Dark Mode */
    --glass-color-one-dark: 245 30% 18% / 0.35; /* hsla(245, 30%, 18%, 0.35) */
    --glass-color-two-dark: 235 35% 20% / 0.3;  /* hsla(235, 35%, 20%, 0.3) */
    --glass-border-color-dark: 240 20% 50% / 0.25; /* Brighter, translucent border */
    --glass-shadow-dark: 0 10px 40px 0 rgba(0, 0, 0, 0.55); /* Adjusted shadow */
    --glass-text-color-dark: hsl(0 0% 95%);
    --glass-blur-intensity-dark: 12px; /* Default blur for dark */
  }

  .theme-glassmorphism {
    /* Main page background gradient for glassmorphism theme */
    background-image: linear-gradient(145deg, hsl(220, 60%, 90%), hsl(200, 50%, 85%)); /* Light mode page background */
    background-attachment: fixed;
    background-size: cover;
    
    /* Redefine component vars for glassmorphism */
    --card: transparent; 
    --popover: transparent;
    
    /* These are the properties that glass surfaces will use */
    --glass-surface-background-image: linear-gradient(135deg, var(--dynamic-glass-color-one), var(--dynamic-glass-color-two));
    --glass-surface-backdrop-filter: blur(var(--dynamic-glass-blur));
    --glass-surface-webkit-backdrop-filter: blur(var(--dynamic-glass-blur));
    --glass-surface-border: 1px solid var(--dynamic-glass-border-color);
    --glass-surface-box-shadow: var(--glass-shadow-light);
    --glass-surface-border-radius: var(--radius);
    --glass-surface-text-color: var(--dynamic-glass-text-color);

    --card-foreground: var(--dynamic-glass-text-color);
    --popover-foreground: var(--dynamic-glass-text-color);
    --muted-foreground: color-mix(in srgb, var(--dynamic-glass-text-color) 60%, transparent);
  }
  
  .theme-glassmorphism.dark {
      /* Dark mode page background gradient */
      background-image: linear-gradient(145deg, hsl(260, 50%, 10%), hsl(230, 40%, 15%));
      
      --dynamic-glass-color-one: hsl(var(--glass-color-one-dark));
      --dynamic-glass-color-two: hsl(var(--glass-color-two-dark));
      --dynamic-glass-border-color: hsl(var(--glass-border-color-dark));
      --dynamic-glass-shadow: var(--glass-shadow-dark);
      --dynamic-glass-text-color: var(--glass-text-color-dark);
      --dynamic-glass-blur: var(--glass-blur-intensity-dark);
  }

  .theme-glassmorphism:not(.dark) {
      --dynamic-glass-color-one: hsl(var(--glass-color-one-light));
      --dynamic-glass-color-two: hsl(var(--glass-color-two-light));
      --dynamic-glass-border-color: hsl(var(--glass-border-color-light));
      --dynamic-glass-shadow: var(--glass-shadow-light);
      --dynamic-glass-text-color: var(--glass-text-color-light);
      --dynamic-glass-blur: var(--glass-blur-intensity-light);
  }

  @keyframes flowing-gradient {
    0% { background-position: 0% 0%; }
    50% { background-position: 100% 100%; }
    100% { background-position: 0% 0%; }
  }
}

/* Define glass effect properties outside of layers or in @layer utilities */
.apply-glass-effect {
  background-image: var(--glass-surface-background-image) !important;
  background-color: transparent !important; /* Override explicit bg-card etc. */
  backdrop-filter: var(--glass-surface-backdrop-filter) !important;
  -webkit-backdrop-filter: var(--glass-surface-webkit-backdrop-filter) !important;
  border: var(--glass-surface-border) !important;
  box-shadow: var(--glass-surface-box-shadow) !important;
  border-radius: var(--glass-surface-border-radius) !important;
  color: var(--glass-surface-text-color) !important;
}

.apply-glass-animation {
  animation: flowing-gradient 20s linear infinite;
  background-size: 300% 300% !important; /* Needs to be larger for animation */
}


@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
  /* Ensure body also gets the gradient when theme is active */
  .theme-glassmorphism body {
     background-image: inherit; /* Inherit from html element */
     background-attachment: inherit;
     background-size: inherit;
  }
}


/* Apply glass effect to specific components */
@layer components {
  .theme-glassmorphism {
    /* Card: Targets the div from Card component in ui/card.tsx */
    .rounded-lg.border.bg-card.text-card-foreground.shadow-sm {
      @apply apply-glass-effect;
    }

    /* PopoverContent: Targets content part of Popover and fallbacks */
    [data-radix-popper-content-wrapper] > .z-50.w-72.rounded-md.border.bg-popover.p-4.text-popover-foreground.shadow-md,
    .bg-popover[role="dialog"], .bg-popover[data-state="open"],
    .bg-popover.text-popover-foreground.shadow-md { /* Covers dropdowns/selects that might use these classes */
        &:not(:where(.dummy-selector-to-lower-specificity)) { /* Scoping to avoid over-applying to non-target popovers */
             @apply apply-glass-effect;
        }
    }

    /* DialogContent: Targets content part of Dialog and fallbacks */
    /* Specific selector for default DialogContent style */
    .fixed.left-\[50\%\].top-\[50\%\].z-50.grid.w-full.max-w-lg.translate-x-\[-50\%\].translate-y-\[-50\%\].gap-4.border.bg-background.p-6.shadow-lg.sm\:rounded-lg[role="dialog"],
    /* General fallback for Dialogs/AlertDialogs using bg-background */
    .bg-background[role="alertdialog"], .bg-background[role="dialog"] {
       &:not(:where(.dummy-selector-to-lower-specificity)) { /* Scoping */
            @apply apply-glass-effect;
       }
    }

    /* SheetContent: Targets content part of Sheet */
    /* Specific selector for default SheetContent style */
    .fixed.z-50.gap-4.bg-background.p-6.shadow-lg {
      @apply apply-glass-effect;
    }
    
    /* App Header (from AppLayout - sticky top-0 ... bg-card ) */
    header.sticky.bg-card {
      @apply apply-glass-effect;
      border-radius: 0 !important; /* Headers typically aren't rounded */
    }

    /* App Footer (from AppLayout - py-4 ... border-t) */
    footer.border-t { 
      @apply apply-glass-effect;
      border-radius: 0 !important;
    }
    
    /* Mobile Nav Bar (from AppLayout - fixed bottom-0 ... bg-card) */
    nav.fixed.bottom-0.bg-card {
        @apply apply-glass-effect;
        border-radius: 0 !important;
    }
    
    /* Radix UI specific data attributes if they bypass simple class selectors */
    [data-radix-select-content],
    [data-radix-dropdown-menu-content] {
        @apply apply-glass-effect;
    }

    /* Adjust input fields on glassmorphism theme for better visibility */
    input, textarea, select, .bg-input,
    .bg-background input, .bg-background textarea, .bg-background select {
        background-color: color-mix(in srgb, var(--dynamic-glass-border-color) 20%, transparent) !important;
        border-color: color-mix(in srgb, var(--dynamic-glass-border-color) 70%, transparent) !important;
        color: var(--dynamic-glass-text-color) !important;
    }
     input::placeholder, textarea::placeholder {
        color: color-mix(in srgb, var(--dynamic-glass-text-color) 60%, transparent) !important;
    }
    
    /* Primary button (bg-primary) uses CSS variables and should adapt well, but ensure text is readable */
    .bg-primary {
        color: var(--primary-foreground) !important; /* Ensure primary button text is always its foreground color */
    }
    .bg-accent {
        color: var(--accent-foreground) !important;
    }

    /* Outline button specific overrides for glassmorphism */
    .border.border-input.bg-background.hover\:bg-accent.hover\:text-accent-foreground,
    button[variant="outline"] {
        background-color: transparent !important;
        border-color: var(--dynamic-glass-text-color) !important;
        color: var(--dynamic-glass-text-color) !important;
    }
    /* Hover state for the outline button in glassmorphism */
    .border.border-input.bg-background.hover\:bg-accent.hover\:text-accent-foreground:hover,
    button[variant="outline"]:hover {
        background-color: color-mix(in srgb, var(--dynamic-glass-text-color) 15%, transparent) !important;
        border-color: var(--dynamic-glass-text-color) !important;
        color: var(--dynamic-glass-text-color) !important; 
    }
  }

  /* Apply animation conditionally */
  .theme-glassmorphism.animate-gradient {
    /* Selectors that should have the animation when glass effect is active */
    .rounded-lg.border.bg-card.text-card-foreground.shadow-sm,
    [data-radix-popper-content-wrapper] > .z-50.w-72.rounded-md.border.bg-popover.p-4.text-popover-foreground.shadow-md,
    .bg-popover[role="dialog"]:not(:where(.dummy-selector-to-lower-specificity)), .bg-popover[data-state="open"]:not(:where(.dummy-selector-to-lower-specificity)),
    .bg-popover.text-popover-foreground.shadow-md:not(:where(.dummy-selector-to-lower-specificity)),
    .fixed.left-\[50\%\].top-\[50\%\].z-50.grid.w-full.max-w-lg.translate-x-\[-50\%\].translate-y-\[-50\%\].gap-4.border.bg-background.p-6.shadow-lg.sm\:rounded-lg[role="dialog"],
    .bg-background[role="alertdialog"]:not(:where(.dummy-selector-to-lower-specificity)), .bg-background[role="dialog"]:not(:where(.dummy-selector-to-lower-specificity)),
    .fixed.z-50.gap-4.bg-background.p-6.shadow-lg,
    header.sticky.bg-card,
    footer.border-t,
    nav.fixed.bottom-0.bg-card,
    [data-radix-select-content],
    [data-radix-dropdown-menu-content] {
      @apply apply-glass-animation;
    }
  }
}
